!function t(n,e,r){function i(u,s){if(!e[u]){if(!n[u]){var a="function"==typeof require&&require;if(!s&&a)return a(u,!0);if(o)return o(u,!0);throw new Error("Cannot find module '"+u+"'")}var l=e[u]={exports:{}};n[u][0].call(l.exports,function(t){var e=n[u][1][t];return i(e?e:t)},l,l.exports,t,n,e,r)}return e[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(t,n){var e;e=function(){function t(n,e){this.parent=null!=e?e:null,this.id=t.id(),this.nodes=[],n&&this.add(n)}return t.index=0,t.id=function(){return++t.index},t.IN=0,t.OUT=1,t.prototype.inputs=function(){var t,n,e,r,i,o,u,s,a;for(t=[],s=this.nodes,r=0,o=s.length;o>r;r++)for(n=s[r],a=n.inputs,i=0,u=a.length;u>i;i++)e=a[i],null===e.input&&t.push(e);return t},t.prototype.outputs=function(){var t,n,e,r,i,o,u,s,a;for(e=[],s=this.nodes,r=0,o=s.length;o>r;r++)for(t=s[r],a=t.outputs,i=0,u=a.length;u>i;i++)n=a[i],0===n.output.length&&e.push(n);return e},t.prototype.getIn=function(t){var n;return function(){var e,r,i,o;for(i=this.inputs(),o=[],e=0,r=i.length;r>e;e++)n=i[e],n.name===t&&o.push(n);return o}.call(this)[0]},t.prototype.getOut=function(t){var n;return function(){var e,r,i,o;for(i=this.outputs(),o=[],e=0,r=i.length;r>e;e++)n=i[e],n.name===t&&o.push(n);return o}.call(this)[0]},t.prototype.add=function(t,n){var e,r,i;{if(!t.length){if(t.graph&&!n)throw"Adding node to two graphs at once";return t.graph=this,this.nodes.push(t)}for(e=0,r=t.length;r>e;e++)i=t[e],this.add(i)}},t.prototype.remove=function(t,n){var e,r,i;{if(!t.length){if(t.graph!==this)throw"Removing node from wrong graph.";return n||t.disconnect(),this.nodes.splice(this.nodes.indexOf(t),1),t.graph=null}for(e=0,r=t.length;r>e;e++)i=t[e],this.remove(i)}},t.prototype.adopt=function(t){var n,e,r;{if(!t.length)return t.graph.remove(t,!0),this.add(t,!0);for(n=0,e=t.length;e>n;n++)r=t[n],this.adopt(r)}},t}(),n.exports=e},{}],2:[function(t,n,e){e.Graph=t("./graph"),e.Node=t("./node"),e.Outlet=t("./outlet"),e.IN=e.Graph.IN,e.OUT=e.Graph.OUT},{"./graph":1,"./node":3,"./outlet":4}],3:[function(t,n){var e,r,i;e=t("./graph"),i=t("./outlet"),r=function(){function t(n,e){this.owner=n,this.graph=null,this.inputs=[],this.outputs=[],this.all=[],this.outlets=null,this.id=t.id(),this.setOutlets(e)}return t.index=0,t.id=function(){return++t.index},t.prototype.getIn=function(t){var n;return function(){var e,r,i,o;for(i=this.inputs,o=[],e=0,r=i.length;r>e;e++)n=i[e],n.name===t&&o.push(n);return o}.call(this)[0]},t.prototype.getOut=function(t){var n;return function(){var e,r,i,o;for(i=this.outputs,o=[],e=0,r=i.length;r>e;e++)n=i[e],n.name===t&&o.push(n);return o}.call(this)[0]},t.prototype.get=function(t){return this.getIn(t)||this.getOut(t)},t.prototype.setOutlets=function(t){var n,e,r,o,u,s,a,l,c,h,p,f;if(null!=t){if(null==this.outlets){for(this.outlets={},s=0,c=t.length;c>s;s++)u=t[s],u instanceof i||(u=i.make(u)),this._add(u);return}for(e=function(t){return[t.name,t.inout,t.type].join("-")},o={},a=0,h=t.length;h>a;a++)u=t[a],o[e(u)]=!0;f=this.outlets;for(r in f)u=f[r],r=e(u),o[r]?o[r]=u:this._remove(u);for(l=0,p=t.length;p>l;l++)u=t[l],n=o[e(u)],n instanceof i?this._morph(n,u):(u instanceof i||(u=i.make(u)),this._add(u))}return this.outlets},t.prototype.connect=function(t,n,e){var r,i,o,u,s,a,l,c,h,p,f,d;for(s={},i={},f=t.inputs,l=0,h=f.length;h>l;l++)u=f[l],(e||!u.input)&&(a=u.type,r=[a,u.hint].join("-"),i[r]||(i[r]=u),s[a]=s[a]||[],s[a].push(u));for(d=this.outputs,c=0,p=d.length;p>c;c++)u=d[c],n&&u.output.length||(a=u.type,r=[a,u.hint].join("-"),o=s[a],i[r]?(i[r].connect(u),delete i[r],o.splice(o.indexOf(u),1)):o&&o.length&&o.shift().connect(u));return this},t.prototype.disconnect=function(){var t,n,e,r,i,o,u;for(o=this.inputs,n=0,r=o.length;r>n;n++)t=o[n],t.disconnect();for(u=this.outputs,e=0,i=u.length;i>e;e++)t=u[e],t.disconnect();return this},t.prototype._key=function(t){return[t.name,t.inout].join("-")},t.prototype._add=function(t){var n;if(n=this._key(t),t.node)throw"Adding outlet to two nodes at once.";if(this.outlets[n])throw"Adding two identical outlets to same node. ("+n+")";return t.node=this,t.inout===e.IN&&this.inputs.push(t),t.inout===e.OUT&&this.outputs.push(t),this.all.push(t),this.outlets[n]=t},t.prototype._morph=function(t,n){var e;return e=this._key(n),delete this.outlets[e],t.morph(n),e=this._key(n),this.outlets[e]=n},t.prototype._remove=function(t){var n,r;if(r=this._key(t),n=t.inout,t.node!==this)throw"Removing outlet from wrong node.";return t.disconnect(),t.node=null,delete this.outlets[r],t.inout===e.IN&&this.inputs.splice(this.inputs.indexOf(t),1),t.inout===e.OUT&&this.outputs.splice(this.outputs.indexOf(t),1),this.all.splice(this.all.indexOf(t),1),this},t}(),n.exports=r},{"./graph":1,"./outlet":4}],4:[function(t,n){var e,r;e=t("./graph"),r=function(){function t(n,e,r,i,o,u){this.inout=n,this.name=e,this.hint=r,this.type=i,this.meta=null!=o?o:{},this.id=u,null==this.hint&&(this.hint=t.hint(e)),this.node=null,this.input=null,this.output=[],null==this.id&&(this.id=t.id(this.hint))}return t.make=function(n,e){var r,i,o,u;if(null==e&&(e={}),i=e,null!=n.meta){u=n.meta;for(r in u)o=u[r],i[r]=o}return new t(n.inout,n.name,n.hint,n.type,i)},t.index=0,t.id=function(n){return"_io_"+ ++t.index+"_"+n},t.hint=function(t){return t=t.replace(/^(_io_[0-9]+_)/,""),t=t.replace(/(In|Out|Inout|InOut)$/,"")},t.prototype.morph=function(t){return this.inout=t.inout,this.name=t.name,this.hint=t.hint,this.type=t.type,this.meta=t.meta},t.prototype.dupe=function(n){var e;return null==n&&(n=this.id),e=t.make(this),e.name=n,e},t.prototype.connect=function(t){if(this.inout===e.IN&&t.inout===e.OUT)return t.connect(this);if(this.inout!==e.OUT||t.inout!==e.IN)throw"Can only connect out to in.";if(t.input!==this)return t.disconnect(),t.input=this,this.output.push(t)},t.prototype.disconnect=function(t){var n,e,r,i;if(this.input&&this.input.disconnect(this),this.output.length){if(!t){for(i=this.output,e=0,r=i.length;r>e;e++)t=i[e],t.input=null;return this.output=[]}if(n=this.output.indexOf(t),n>=0)return this.output.splice(n,1),t.input=null}},t}(),n.exports=r},{"./graph":1}],5:[function(t,n){var e,r,i,o,u;r=t("../graph"),o=t("../linker").Program,i=t("../linker").Layout,u=!1,e=function(){function t(){var t;null==this.namespace&&(this.namespace=o.entry()),this.node=new r.Node(this,null!=(t="function"==typeof this.makeOutlets?this.makeOutlets():void 0)?t:{})}return t.previous=function(t){var n;return null!=(n=t.input)?n.node.owner:void 0},t.prototype.refresh=function(){var t;return this.node.setOutlets(null!=(t="function"==typeof this.makeOutlets?this.makeOutlets():void 0)?t:{})},t.prototype.clone=function(){return new t},t.prototype.compile=function(t,n){var e;return e=new o(t,null!=n?n:o.entry(),this.node.graph),this.call(e,0),e.assemble()},t.prototype.link=function(t,n){var e,r;return r=this.compile(t,n),e=new i(t,this.node.graph),this._include(r,e,0),this["export"](e,0),e.link(r)},t.prototype.call=function(){},t.prototype.callback=function(){},t.prototype["export"]=function(){},t.prototype._info=function(t){var n,e,r;return n=null!=(e=null!=(r=this.node.owner.snippet)?r._name:void 0)?e:this.node.owner.namespace,null!=t?n+="."+t:void 0},t.prototype._outlet=function(t,n){var e;return e=r.Outlet.make(t,n),e.meta.def=t,e},t.prototype._call=function(t,n,e){return n.call(this.node,t,e)},t.prototype._require=function(t,n){return n.require(this.node,t)},t.prototype._inputs=function(n,e,r){var i,o,u,s,a,l,c;for(a=n.main.signature,c=[],u=0,s=a.length;s>u;u++)i=a[u],o=this.node.get(i.name),c.push(null!=(l=t.previous(o))?l.call(e,r+1):void 0);return c},t.prototype._callback=function(t,n,e,r,i,o){return n.callback(this.node,t,e,r,i,o)},t.prototype._include=function(t,n,e){return n.include(this.node,t,e)},t.prototype._link=function(n,e,r){var i,o,s,a,l,c,h,p,f,d,g,m;for(u&&console.log("block::_link",this.toString(),n.namespace),f=n.symbols,m=[],h=0,p=f.length;p>h;h++){if(s=f[h],o=n.externals[s],l=this.node.get(o.name),!l)throw Error("OutletError: External not found on "+this._info(o.name));if(null==l.meta.child){for(d=[l,l,null],a=d[0],c=d[1],i=d[2];!i&&c;)g=[l.meta.parent,c],c=g[0],l=g[1];if(i=t.previous(l),!i)throw Error("OutletError: Missing connection on "+this._info(o.name));u&&console.log("callback -> ",this.toString(),o.name,l),i.callback(e,r+1,s,o,l.input),m.push(null!=i?i["export"](e,r+1):void 0)}}return m},t.prototype._trace=function(n,e,r){var i,o,s,a,l,c,h;for(u&&console.log("block::_trace",this.toString(),n.namespace),l=n.main.signature,h=[],s=0,a=l.length;a>s;s++)i=l[s],o=this.node.get(i.name),h.push(null!=(c=t.previous(o))?c["export"](e,r+1):void 0);return h},t}(),n.exports=e},{"../graph":25,"../linker":30}],6:[function(t,n){var e,r,i={}.hasOwnProperty,o=function(t,n){function e(){this.constructor=t}for(var r in n)i.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t};e=t("./block"),r=function(t){function n(t){this.snippet=t,this.namespace=this.snippet.namespace,n.__super__.constructor.apply(this,arguments)}return o(n,t),n.prototype.clone=function(){return new n(this.snippet)},n.prototype.makeOutlets=function(){var t,n,e,r,i,o,u;return r=this.snippet.main.signature,n=this.snippet.externals,u=this.snippet.symbols,o=function(){var t,n,e;for(e=[],t=0,n=r.length;n>t;t++)i=r[t],e.push(this._outlet(i,{callback:!1}));return e}.call(this),t=function(){var t,r,i;for(i=[],t=0,r=u.length;r>t;t++)e=u[t],i.push(this._outlet(n[e],{callback:!0}));return i}.call(this),o.concat(t)},n.prototype.call=function(t,n){return this._call(this.snippet,t,n),this._inputs(this.snippet,t,n)},n.prototype["export"]=function(t,n){return t.visit(this.namespace,n)?(this._link(this.snippet,t,n),this._trace(this.snippet,t,n)):void 0},n}(e),n.exports=r},{"./block":5}],7:[function(t,n){var e,r,i,o={}.hasOwnProperty,u=function(t,n){function e(){this.constructor=t}for(var r in n)o.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t};i=t("../graph"),e=t("./block"),r=function(t){function n(t){this.graph=t,n.__super__.constructor.apply(this,arguments)}return u(n,t),n.prototype.refresh=function(){return n.__super__.refresh.apply(this,arguments),delete this.subroutine},n.prototype.clone=function(){return new n(this.graph)},n.prototype.makeOutlets=function(){var t,n,e,r,o,u,s,a,l,c,h,p;for(this.make(),r=[],n=[],o=[],t=function(){return function(t,n){var e,o;return t.meta.callback?t.inout===i.IN?(e=t.dupe(),null==(o=e.meta).child&&(o.child=t),t.meta.parent=e,r.push(e)):void 0:n.push(t.type)}}(this),h=this.graph.inputs(),s=0,l=h.length;l>s;s++)e=h[s],t(e,n);for(p=this.graph.outputs(),a=0,c=p.length;c>a;a++)e=p[a],t(e,o);return n=n.join(","),o=o.join(","),u="("+n+")("+o+")",r.push({name:"callback",type:u,inout:i.OUT,meta:{callback:!0,def:this.subroutine.main}}),r},n.prototype.make=function(){return this.subroutine=this.graph.compile(this.namespace)},n.prototype["export"]=function(t,n){return t.visit(this.namespace,n)?(this._link(this.subroutine,t,n),this.graph["export"](t,n)):void 0},n.prototype.call=function(t,n){return this._require(this.subroutine,t,n)},n.prototype.callback=function(t,n,e,r,i){return this._include(this.subroutine,t,n),this._callback(this.subroutine,t,n,e,r,i)},n}(e),n.exports=r},{"../graph":25,"./block":5}],8:[function(t,n,e){e.Block=t("./block"),e.Call=t("./call"),e.Callback=t("./callback"),e.Isolate=t("./isolate"),e.Join=t("./join")},{"./block":5,"./call":6,"./callback":7,"./isolate":9,"./join":10}],9:[function(t,n){var e,r,i,o={}.hasOwnProperty,u=function(t,n){function e(){this.constructor=t}for(var r in n)o.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t};r=t("../graph"),e=t("./block"),i=function(t){function n(t){this.graph=t,n.__super__.constructor.apply(this,arguments)}return u(n,t),n.prototype.refresh=function(){return n.__super__.refresh.apply(this,arguments),delete this.subroutine},n.prototype.clone=function(){return new n(this.graph)},n.prototype.makeOutlets=function(){var t,n,e,i,o,u,s,a,l,c,h,p,f,d,g;for(this.make(),o=[],u={},t={},f=["inputs","outputs"],l=0,h=f.length;h>l;l++)for(s=f[l],d=this.graph[s](),c=0,p=d.length;p>c;c++)i=d[c],e=void 0,"return"!==(g=i.hint)&&"callback"!==g||i.inout!==r.OUT||(e=i.hint),null!=u[e]&&(e=void 0),n=i.dupe(e),null==(a=n.meta).child&&(a.child=i),i.meta.parent=n,null!=e&&(u[e]=!0),t[i.name]=n,o.push(n);return o},n.prototype.make=function(){return this.subroutine=this.graph.compile(this.namespace)},n.prototype.call=function(t,n){return this._call(this.subroutine,t,n),this._inputs(this.subroutine,t,n)},n.prototype["export"]=function(t,n){return t.visit(this.namespace,n)?(this._link(this.subroutine,t,n),this._trace(this.subroutine,t,n),this.graph["export"](t,n)):void 0},n.prototype.callback=function(t,n,e,r,i){return i=i.meta.child,i.node.owner.callback(t,n,e,r,i)},n}(e),n.exports=i},{"../graph":25,"./block":5}],10:[function(t,n){var e,r,i={}.hasOwnProperty,o=function(t,n){function e(){this.constructor=t}for(var r in n)i.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t};e=t("./block"),r=function(t){function n(t){this.nodes=t,n.__super__.constructor.apply(this,arguments)}return o(n,t),n.prototype.clone=function(){return new n(this.nodes)},n.prototype.makeOutlets=function(){return[]},n.prototype.call=function(t,n){var e,r,i,o,u,s;for(u=this.nodes,s=[],i=0,o=u.length;o>i;i++)r=u[i],e=r.owner,s.push(e.call(t,n));return s},n.prototype["export"]=function(t,n){var e,r,i,o,u,s;for(u=this.nodes,s=[],i=0,o=u.length;o>i;i++)r=u[i],e=r.owner,s.push(e["export"](t,n));return s},n}(e),n.exports=r},{"./block":5}],11:[function(t,n){var e,r,i;i=t("./queue"),r=t("./hash"),e=function(t){var n,e;return n={},e=i(100),function(i){var o,u;return u=i.length>32?"##"+r(i).toString(16):i,o=e(u),null!=o&&delete n[o],null==n[u]&&(n[u]=t(i)),n[u].clone()}},n.exports=e},{"./hash":13,"./queue":17}],12:[function(t,n){var e,r,i,o,u;i=t("../graph").Graph,e=t("../block"),u=t("../visualize"),r=function(){function t(t,n,e){this.language=t,this.fetch=n,this.config=e,this.graph()}return t.prototype.pipe=function(n,e,r,i){return n instanceof t?this._concat(n):this._call(n,e,r,i),this},t.prototype.call=function(t,n,e,r){return this.pipe(t,n,e,r)},t.prototype.require=function(n,e,r,i){return n instanceof t?this._import(n):(this.callback(),this._call(n,e,r,i),this.end()),this},t.prototype["import"]=function(t,n,e,r){return this.require(t,n,e,r)},t.prototype.split=function(){return this._group("_combine",!0),this},t.prototype.fan=function(){return this._group("_combine",!1),this},t.prototype.isolate=function(){return this._group("_isolate"),this},t.prototype.callback=function(){return this._group("_callback"),this},t.prototype.next=function(){return this._next(),this},t.prototype.pass=function(){var t;return t=this._stack[2].end,this.end(),this._state.end=this._state.end.concat(t),this},t.prototype.end=function(){var t,n,e,r;return r=this._exit(),e=r[0],t=r[1],n=e.op,this[n]&&this[n](e,t),this},t.prototype.join=function(){return this.end()},t.prototype.graph=function(){for(var t,n;(null!=(n=this._stack)?n.length:void 0)>1;)this.end();return this._graph&&this._tail(this._state,this._graph),t=this._graph,this._graph=new i,this._state=new o,this._stack=[this._state],t},t.prototype.compile=function(t){return null==t&&(t="main"),this.graph().compile(t)},t.prototype.link=function(t){return null==t&&(t="main"),this.graph().link(t)},t.prototype.serialize=function(){return u.serialize(this._graph)},t.prototype.empty=function(){return 0===this._graph.nodes.length},t.prototype._concat=function(t){var n,r;this._tail(t._state,t._graph);try{n=new e.Isolate(t._graph)}catch(i){throw r=i,this.config.autoInspect&&u.inspect(r,this._graph,t),r}return this._auto(n),this},t.prototype._import=function(t){var n,r;this._tail(t._state,t._graph);try{n=new e.Callback(t._graph)}catch(i){throw r=i,this.config.autoInspect&&u.inspect(r,this._graph,t),r}return this._auto(n),this},t.prototype._combine=function(t,n){var e,r,i,o,u,s,a,l;for(a=t.start,i=0,u=a.length;u>i;i++)for(r=a[i],l=n.end,o=0,s=l.length;s>o;o++)e=l[o],e.connect(r,t.multi);return n.end=t.end,n.nodes=n.nodes.concat(t.nodes)},t.prototype._isolate=function(t){var n,r,i;if(t.nodes.length){i=this._subgraph(t),this._tail(t,i);try{n=new e.Isolate(i)}catch(o){throw r=o,this.config.autoInspect&&u.inspect(r,this._graph,i),r}return this._auto(n)}},t.prototype._callback=function(t){var n,r,i;if(t.nodes.length){i=this._subgraph(t),this._tail(t,i);try{n=new e.Callback(i)}catch(o){throw r=o,this.config.autoInspect&&u.inspect(r,this._graph,i),r}return this._auto(n)}},t.prototype._call=function(t,n,r,i){var o,u;return u=this.fetch(t),u.bind(this.config,n,r,i),o=new e.Call(u),this._auto(o)},t.prototype._subgraph=function(t){var n;return n=new i(null,this._graph),n.adopt(t.nodes),n},t.prototype._tail=function(t,n){var r;if(r=t.end.concat(t.tail),r=r.filter(function(t,n){return r.indexOf(t)===n}),r.length>1&&(r=new e.Join(r),r=[r.node],this._graph.add(r)),n.tail=r[0],t.end=r,t.tail=[],!n.tail)throw"Cannot finalize empty graph";return n.compile=function(t){return function(e){var r;null==e&&(e="main");try{return n.tail.owner.compile(t.language,e)}catch(i){throw r=i,t.config.autoInspect&&n.inspect(r),r}}}(this),n.link=function(t){return function(e){var r;null==e&&(e="main");try{return n.tail.owner.link(t.language,e)}catch(i){throw r=i,t.config.autoInspect&&n.inspect(r),r}}}(this),n["export"]=function(){return function(t,e){return n.tail.owner["export"](t,e)}}(this),n.inspect=function(t){return null==t&&(t=null),u.inspect(t,n)}},t.prototype._group=function(t,n){return this._push(t,n),this._push(),this},t.prototype._next=function(){var t;return t=this._pop(),this._state.start=this._state.start.concat(t.start),this._state.end=this._state.end.concat(t.end),this._state.nodes=this._state.nodes.concat(t.nodes),this._state.tail=this._state.tail.concat(t.tail),this._push()},t.prototype._exit=function(){return this._next(),this._pop(),[this._pop(),this._state]},t.prototype._push=function(t,n){return this._stack.unshift(new o(t,n)),this._state=this._stack[0]},t.prototype._pop=function(){var t;return this._state=this._stack[1],null==this._state&&(this._state=new o),null!=(t=this._stack.shift())?t:new o},t.prototype._auto=function(t){return t.node.inputs.length?this._append(t):this._insert(t)},t.prototype._append=function(t){var n,e,r,i,o;for(e=t.node,this._graph.add(e),o=this._state.end,r=0,i=o.length;i>r;r++)n=o[r],n.connect(e);return this._state.start.length||(this._state.start=[e]),this._state.end=[e],this._state.nodes.push(e),e.outputs.length?void 0:this._state.tail.push(e)},t.prototype._prepend=function(t){var n,e,r,i,o;for(n=t.node,this._graph.add(n),o=this._state.start,r=0,i=o.length;i>r;r++)e=o[r],n.connect(e);return this._state.end.length||(this._state.end=[n]),this._state.start=[n],this._state.nodes.push(n),n.outputs.length?void 0:this._state.tail.push(n)},t.prototype._insert=function(t){var n;return n=t.node,this._graph.add(n),this._state.start.push(n),this._state.end.push(n),this._state.nodes.push(n),n.outputs.length?void 0:this._state.tail.push(n)},t}(),o=function(){function t(t,n,e,r,i,o){this.op=null!=t?t:null,this.multi=null!=n?n:!1,this.start=null!=e?e:[],this.end=null!=r?r:[],this.nodes=null!=i?i:[],this.tail=null!=o?o:[]}return t}(),n.exports=r},{"../block":8,"../graph":25,"../visualize":36}],13:[function(t,n){var e,r,i,o,u,s,a,l;e=3432918353,r=461845907,i=3864292196,o=2246822507,u=3266489909,a=function(t,n){var e,r,i,o;return e=t>>>16&65535,r=65535&t,i=n>>>16&65535,o=65535&n,r*o+(e*o+r*i<<16>>>0)|0},null!=Math.imul&&(l=Math.imul(4294967295,5),-5===l&&(a=Math.imul)),s=function(t){var n,s,l,c,h,p;for(h=t.length,c=Math.floor(h/2),l=n=0,p=function(){return t.charCodeAt(l++)},s=function(t,o){var u;return u=t|o<<16,u^=u<<9,u=a(u,e),u=u<<15|u>>>17,u=a(u,r),n^=u,n=n<<13|n>>>19,n=a(n,5),n=n+i|0};c--;)s(p(),p());return 1&h&&s(p(),0),n^=h,n^=n>>>16,n=a(n,o),n^=n>>>13,n=a(n,u),n^=n>>>16},n.exports=s},{}],14:[function(t,n,e){e.Factory=t("./factory"),e.Material=t("./material"),e.library=t("./library"),e.cache=t("./cache"),e.queue=t("./queue"),e.hash=t("./hash")},{"./cache":11,"./factory":12,"./hash":13,"./library":15,"./material":16,"./queue":17}],15:[function(t,n){var e;e=function(t,n,e){var r,i;return r=null,null!=n&&("function"==typeof n?r=function(r){return e(t,r,n(r))}:"object"==typeof n&&(r=function(r){if(null==n[r])throw"Unknown snippet `"+r+"`";return e(t,r,n[r])})),i=function(n){return e(t,"",n)},null==r?i:function(t){return t.match(/[{;]/)?i(t):r(t)}},n.exports=e},{}],16:[function(t,n){var e,r,i;r=!1,i=function(){var t;return t=+new Date,function(n){var e;return e=+new Date-t,console.log(n,e+" ms"),e}},e=function(){function t(t,n){this.vertex=t,this.fragment=n,r&&(this.tock=i())}return t.prototype.build=function(t){return this.link(t)},t.prototype.link=function(t){var n,e,i,o,u,s,a,l,c,h,p,f,d,g;for(null==t&&(t={}),u={},a={},n={},l=this.vertex.link("main"),e=this.fragment.link("main"),p=[l,e],c=0,h=p.length;h>c;c++){o=p[c],f=o.uniforms;for(i in f)s=f[i],u[i]=s;d=o.varyings;for(i in d)s=d[i],a[i]=s;g=o.attributes;for(i in g)s=g[i],n[i]=s}return t.vertexShader=l.code,t.vertexGraph=l.graph,t.fragmentShader=e.code,t.fragmentGraph=e.graph,t.attributes=n,t.uniforms=u,t.varyings=a,r&&this.tock("Material build"),t},t}(),n.exports=e},{}],17:[function(t,n){var e;e=function(t){var n,e,r,i,o,u;return null==t&&(t=100),i={},r=null,u=null,e=0,n=function(t){return t.prev=null,t.next=r,null!=r&&(r.prev=t),r=t,null==u?u=t:void 0},o=function(t){var n,e;return e=t.prev,n=t.next,null!=e&&(e.next=n),null!=n&&(n.prev=e),r===t&&(r=n),u===t?u=e:void 0},function(s){var a,l;return(l=i[s]&&l!==r)?(o(l),n(l)):(e===t?(a=u.key,o(u),delete i[a]):e++,l={next:r,prev:null,key:s},n(l),i[s]=l),a}},n.exports=e},{}],18:[function(t,n){var e,r,i,o;e=function(t){var n,e,o,u,s;return e=t.ast,o=t.code,s=t.signatures,u=r(s),n=i(o,u),[s,n]},o=function(){var t;return t=+new Date,function(n){var e;return e=+new Date-t,console.log(n,e+" ms"),e}},r=function(t){var n,e,r,i,o,u,s,a,l,c;for(e={},r=function(t){return e[t.name]=!0},r(t.main),l=["external","internal","varying","uniform","attribute"],o=0,s=l.length;s>o;o++)for(n=l[o],c=t[n],u=0,a=c.length;a>u;u++)i=c[u],r(i);return e},i=function(t,n){var e,r;return r=new RegExp("\\b("+function(){var t;t=[];for(e in n)t.push(e);return t}().join("|")+")\\b","g"),t=t.replace(/\/\/[^\n]*/g,""),t=t.replace(/\/\*([^*]|\*[^\/])*\*\//g,""),function(i,o,u){var s,a,l,c;null==i&&(i=""),null==o&&(o={}),null==u&&(u={}),l={};for(e in n)l[e]=null!=o[e]?e:i+e;return s=t.replace(r,function(t){return l[t]}),a=function(){var t;t=[];for(e in u)c=u[e],t.push("#define "+e+" "+c);return t}(),a.length&&a.push(""),a.join("\n")+s}},n.exports=e},{}],19:[function(t,n){n.exports={SHADOW_ARG:"_i_o",RETURN_ARG:"return"}},{}],20:[function(t,n){var e,r,i,o,u,s,a;n.exports=r={},r["in"]=0,r.out=1,r.inout=2,o=function(t){return t.token.data},r.node=function(t){var n,e;return"function"===(null!=(n=t.children[5])?n.type:void 0)?r["function"](t):"keyword"===(null!=(e=t.token)?e.type:void 0)?r.external(t):void 0},r.external=function(t){var n,e,r,i,u,s,a,l,c,h,p,f,d;for(n=t.children,l=o(n[1]),c=o(n[3]),h=o(n[4]),i=n[5],"attribute"!==l&&"uniform"!==l&&"varying"!==l&&(l="global"),s=[],d=i.children,e=p=0,f=d.length;f>p;e=++p)n=d[e],"ident"===n.type&&(r=o(n),u=i.children[e+1],a="quantifier"===(null!=u?u.type:void 0),s.push({decl:"external",storage:l,type:h,ident:r,quant:!!a,count:a}));return s},r["function"]=function(t){var n,e,i,u,s,a,l,c,h,p;return i=t.children,c=o(i[1]),h=o(i[3]),p=o(i[4]),a=i[5],l=o(a.children[0]),n=a.children[1],e=a.children[2],s=function(){var t,e,i,o;for(i=n.children,o=[],t=0,e=i.length;e>t;t++)u=i[t],o.push(r.argument(u));return o}(),[{decl:"function",storage:c,type:p,ident:l,body:!!e,args:s}]},r.argument=function(t){var n,e,r,i,u,s,a,l;return n=t.children,a=o(n[1]),i=o(n[2]),l=o(n[4]),u=n[5],r=o(u.children[0]),s=u.children[1],e=s?s.children[0].token.data:void 0,{decl:"argument",storage:a,inout:i,type:l,ident:r,quant:!!s,count:e}},r.param=function(t,n,e,i,o){var u,s,a;return s=[],null!=n&&s.push(n),null!=e&&s.push(e),s.push(""),s=s.join(" "),a=i?"["+o+"]":"",""!==t&&(t+=" "),u=function(n,e){return(e?t:"")+(""+s+n+a)},u.split=function(t){return r.param(t,n,e,i,o)},u},a="undefined"!=typeof window,s=a&&!!window.THREE,i={"int":0,"float":0,vec2:s?THREE.Vector2:null,vec3:s?THREE.Vector3:null,vec4:s?THREE.Vector4:null,mat2:null,mat3:s?THREE.Matrix3:null,mat4:s?THREE.Matrix4:null,sampler2D:0,samplerCube:0},u={"int":"i","float":"f",vec2:"v2",vec3:"v3",vec4:"v4",mat2:"m2",mat3:"m3",mat4:"m4",sampler2D:"t",samplerCube:"t"},r.type=function(t,n,o,s,a,l){var c,h,p,f,d,g,m;return c={"in":r["in"],out:r.out,inout:r.inout},f={"const":"const"},d=u[n],o&&(d+="v"),g=i[n],(null!=g?g.call:void 0)&&(g=new g),o&&(g=[g]),h=null!=(m=c[a])?m:c["in"],l=f[l],p=r.param(a,l,n,o,s),new e(t,d,n,p,g,h)},e=function(){function t(t,n,e,r,i,o,u){this.name=t,this.type=n,this.spec=e,this.param=r,this.value=i,this.inout=o,this.meta=u}return t.prototype.split=function(){var n,e,i,o;return i=null!=this.meta.shadowed,n=i?"in":"out",e=i?r["in"]:r.out,o=this.param.split(n),new t(this.name,this.type,this.spec,o,this.value,e)},t.prototype.copy=function(n,e){var r;return r=new t(null!=n?n:this.name,this.type,this.spec,this.param,this.value,this.inout,e)},t}()},{}],21:[function(t,n){var e,r,i;r=t("../graph"),e=t("./constants"),n.exports=i={unshadow:function(t){var n;return n=t.replace(e.SHADOW_ARG,""),n!==t?n:null},lines:function(t){return t.join("\n")},list:function(t){return t.join(", ")},statements:function(t){return t.join(";\n")},body:function(t){return{entry:t,type:"void",params:[],signature:[],"return":"",vars:{},calls:[],post:[],chain:{}}},define:function(t,n){return"#define "+t+" "+n},"function":function(t,n,e,r,i){return""+t+" "+n+"("+e+") {\n"+r+i+"}"},invoke:function(t,n,e){return t=t?""+t+" = ":"",e=i.list(e),"  "+t+n+"("+e+")"},same:function(t,n){var r,i,o,u,s;for(o=u=0,s=t.length;s>u;o=++u){if(r=t[o],i=n[o],!i)return!1;if(r.type!==i.type)return!1;if(r.name===e.RETURN_ARG!=(i.name===e.RETURN_ARG))return!1}return!0},call:function(t,n,r,o,u){var s,a,l,c,h,p,f,d,g,m,v,y,_,b,k,x,w;for(a=[],v="",y=1,b=0,k=o.length;k>b;b++){if(s=o[b],d=s.name,l=c=t(d),m=null,f=null,g=!1,h=s.inout,p=d===e.RETURN_ARG,(_=null!=(x=s.meta)?x.shadowed:void 0)&&(m=t(_),m&&(u.vars[m]="  "+s.param(m),u.calls.push("  "+m+" = "+c),n(_)?f={shadowed:m}:s=s.split())),(_=null!=(w=s.meta)?w.shadow:void 0)&&(m=t(_))){if(n(_)){f={shadow:m};continue}s=s.split(),g=!0}p?v=c:g||a.push(null!=m?m:c),n(d)?(p?""===u["return"]?(l=d,u.type=s.spec,u["return"]="  return "+c,u.vars[c]="  "+s.param(c)):(u.vars[c]="  "+s.param(c),u.params.push(s.param(c,!0))):u.params.push(s.param(c,!0)),s=s.copy(l,f),u.signature.push(s)):u.vars[c]="  "+s.param(c)}return u.calls.push(i.invoke(v,r,a))},build:function(t,n){var e,r,o,u,s,a,l,c,h,p,f;return s=t.entry,o=null,n&&1===n.length&&"main"!==s&&(e=t,r=n[0].module,i.same(t.signature,r.main.signature)&&(o=i.define(s,r.entry))),null==o&&(f=function(){var n,e;n=t.vars,e=[];for(p in n)u=n[p],e.push(u);return e}(),n=t.calls,l=t.post,a=t.params,h=t.type,c=t["return"],n=n.concat(l),""!==c&&n.push(c),n.push(""),f.length?(f.push(""),f=i.statements(f)+"\n"):f="",n=i.statements(n),a=i.list(a),o=i["function"](h,s,a,f,n)),{signature:t.signature,code:o,name:s}},links:function(t){var n,e,r,o;for(e={defs:[],bodies:[]},r=0,o=t.length;o>r;r++)n=t[r],i.link(n,e);return e.defs=i.lines(e.defs),e.bodies=i.statements(e.bodies),""===e.defs&&delete e.defs,""===e.bodies&&delete e.bodies,e},link:function(){return function(t,n){var o,u,s,a,l,c,h,p,f,d,g,m,v,y,_,b,k,x,w,M,O,C,T,j;if(f=t.module,d=t.name,s=t.external,h=f.main,u=f.entry,i.same(h.signature,s.signature))return n.defs.push(i.define(d,u));for(l=[],v=[],p={},y=[f.namespace,e.RETURN_ARG].join(""),T=s.signature,k=0,w=T.length;w>k;k++)o=T[k],c=o.inout===r.IN?l:v,c.push(o);for(j=h.signature,x=0,M=j.length;M>x;x++)o=j[x],c=o.inout===r.IN?l:v,g=c.shift(),C=g.name,C===e.RETURN_ARG&&(C=y),p[o.name]=C;return O=function(t){return p[t]},b=function(){return!0},a=i.body(),i.call(O,b,u,h.signature,a),a.entry=u,p={"return":y},O=function(t){var n;return null!=(n=p[t])?n:t},m=i.body(),_=i.call(O,b,u,s.signature,m),m.calls=a.calls,m.entry=d,n.bodies.push(i.build(a).code.split(" {")[0]),n.bodies.push(i.build(m).code)}}(this),defuse:function(t){var n,e,r,i,o,u,s,a,l,c,h,p,f,d,g;for(l=/([A-Za-z0-9_]+\s+)?[A-Za-z0-9_]+\s+[A-Za-z0-9_]+\s*\([^)]*\)\s*;\s*/gm,h=function(t){return t.replace(l,function(){return""})},e=t.split(/(?=[{}])/g),s=0,o=p=0,d=e.length;d>p;o=++p){switch(n=e[o],n[0]){case"{":s++;break;case"}":s--}if(0===s){for(r=n.split(/^[ \t]*#/m),u=f=0,g=r.length;g>f;u=++f)a=r[u],u>0?(a=a.split(/\n/),i=a.shift(),c=a.join("\n"),r[u]=[i,h(c)].join("\n")):r[u]=h(a);e[o]=r.join("#")}}return t=e.join("")},dedupe:function(t){var n,e;return n={},e=/((attribute|uniform|varying)\s+)[A-Za-z0-9_]+\s+([A-Za-z0-9_]+)\s*(\[[^\]]*\]\s*)?;\s*/gm,t.replace(e,function(t,e,r,i){return n[i]?"":(n[i]=!0,t)})},hoist:function(t){var n,e,r,i,o,u,s,a;for(u=/^#define ([^ ]+ _pg_[0-9]+_|_pg_[0-9]+_ [^ ]+)$/,r=t.split(/\n/g),n=[],o=[],s=0,a=r.length;a>s;s++)e=r[s],i=e.match(u)?n:o,i.push(e);return n.concat(o).join("\n")}}},{"../graph":25,"./constants":19}],22:[function(t,n,e){var r,i,o,u,s;for(e.compile=t("./compile"),e.parse=t("./parse"),e.generate=t("./generate"),s=t("./constants"),i=o=0,u=s.length;u>o;i=++o)r=s[i],e[r]=i},{"./compile":18,"./constants":19,"./generate":21,"./parse":23}],23:[function(t,n){var e,r,i,o,u,s,a,l,c,h,p,f,d,g;d=t("../../vendor/glsl-tokenizer"),c=t("../../vendor/glsl-parser"),o=t("./decl"),e=t("./constants"),i=!1,a=function(t,n){var e,r;return e=l(t,n),r=h(e,n)},l=function(t,n){var e,r,o,u,s,a,l,h;if(i&&(u=f()),l=d().process(c(),n),h=l[0],e=h[0],o=l[1],i&&u("GLSL Tokenize & Parse"),!e||o.length){for(t||(t="(inline code)"),s=0,a=o.length;a>s;s++)r=o[s],console.error("[ShaderGraph] "+t+" -",r.message);throw"GLSL parse error"}return e},h=function(t,n){var e,o,a,l,c,h,d;return i&&(h=f()),c=[],g(s,r(c),t,""),d=p(c),a=d[0],o=d[1],e=d[2],l=u(a,o,e),i&&h("GLSL AST"),{ast:t,code:n,signatures:l}},s=function(t,n){switch(t.type){case"decl":return n(o.node(t)),!1}return!0},r=function(t){return function(n){var e,r,i,o;if(null!=n){for(o=[],r=0,i=n.length;i>r;r++)e=n[r],o.push(t.push(e));return o}}},p=function(t){var n,e,r,i,o,u,s,a,l;for(o=null,i=[],e=[],u={},r=!1,a=0,l=t.length;l>a;a++)s=t[a],s.body?(u[s.ident]&&(e=function(){var t,r,i;for(i=[],t=0,r=e.length;r>t;t++)n=e[t],n.ident!==s.ident&&i.push(n);return i}(),delete u[s.ident]),i.push(s),"main"===s.ident?(o=s,r=!0):r||(o=s)):"global"===s.storage?i.push(s):(e.push(s),u[s.ident]=!0);return[o,i,e]},u=function(t,n,r){var i,u,s,a,l,c,h,p,f;for(a={uniform:[],attribute:[],varying:[],external:[],internal:[],global:[],main:null},u=function(t){return o.type(t.ident,t.type,t.quant,t.count,t.inout,t.storage)},s=function(t,n){var r,i,s,a,l,c,h,p,f,d,g;for(p=function(){var n,e,r,o;for(r=t.args,o=[],n=0,e=r.length;e>n;n++)i=r[n],o.push(u(i));return o}(),d=0,g=p.length;g>d;d++)a=p[d],a.inout===o.inout&&(r=a,s=a.copy(),r.inout=o["in"],s.inout=o.out,s.meta={shadow:r.name},s.name+=e.SHADOW_ARG,r.meta={shadowed:s.name},p.push(s));return"void"!==t.type&&p.push(o.type(e.RETURN_ARG,t.type,!1,"","out")),c=function(){var t,n,e;for(e=[],t=0,n=p.length;n>t;t++)a=p[t],a.inout===o["in"]&&e.push(a.type);return e}().join(","),h=function(){var t,n,e;for(e=[],t=0,n=p.length;n>t;t++)a=p[t],a.inout===o.out&&e.push(a.type);return e}().join(","),f="("+c+")("+h+")",l={name:t.ident,type:f,signature:p,inout:n,spec:t.type}},a.main=s(t,o.out),c=0,p=n.length;p>c;c++)l=n[c],a.internal.push({name:l.ident});for(h=0,f=r.length;f>h;h++)switch(l=r[h],l.decl){case"external":i=u(l),a[l.storage].push(i);break;case"function":i=s(l,o["in"]),a.external.push(i)
}return a},i=!1,g=function(t,n,e,r){var o,u,s,a,l,c,h,p;if(i&&console.log(r,e.type,null!=(c=e.token)?c.data:void 0,null!=(h=e.token)?h.type:void 0),s=t(e,n))for(p=e.children,u=a=0,l=p.length;l>a;u=++a)o=p[u],g(t,n,o,r+"  ",i);return null},f=function(){var t;return t=+new Date,function(n){var e;return e=+new Date-t,console.log(n,e+" ms"),e}},n.exports=g,n.exports=a},{"../../vendor/glsl-parser":39,"../../vendor/glsl-tokenizer":43,"./constants":19,"./decl":20}],24:[function(t,n){var e;e=function(){function t(n,e){this.parent=null!=e?e:null,this.id=t.id(),this.nodes=[],n&&this.add(n)}return t.index=0,t.id=function(){return++t.index},t.IN=0,t.OUT=1,t.prototype.inputs=function(){var t,n,e,r,i,o,u,s,a;for(t=[],s=this.nodes,r=0,o=s.length;o>r;r++)for(n=s[r],a=n.inputs,i=0,u=a.length;u>i;i++)e=a[i],null===e.input&&t.push(e);return t},t.prototype.outputs=function(){var t,n,e,r,i,o,u,s,a;for(e=[],s=this.nodes,r=0,o=s.length;o>r;r++)for(t=s[r],a=t.outputs,i=0,u=a.length;u>i;i++)n=a[i],0===n.output.length&&e.push(n);return e},t.prototype.getIn=function(t){var n;return function(){var e,r,i,o;for(i=this.inputs(),o=[],e=0,r=i.length;r>e;e++)n=i[e],n.name===t&&o.push(n);return o}.call(this)[0]},t.prototype.getOut=function(t){var n;return function(){var e,r,i,o;for(i=this.outputs(),o=[],e=0,r=i.length;r>e;e++)n=i[e],n.name===t&&o.push(n);return o}.call(this)[0]},t.prototype.add=function(t,n){var e,r,i;{if(!t.length){if(t.graph&&!n)throw"Adding node to two graphs at once";return t.graph=this,this.nodes.push(t)}for(e=0,r=t.length;r>e;e++)i=t[e],this.add(i)}},t.prototype.remove=function(t,n){var e,r,i;{if(!t.length){if(t.graph!==this)throw"Removing node from wrong graph.";return n||t.disconnect(),this.nodes.splice(this.nodes.indexOf(t),1),t.graph=null}for(e=0,r=t.length;r>e;e++)i=t[e],this.remove(i)}},t.prototype.adopt=function(t){var n,e,r;{if(!t.length)return t.graph.remove(t,!0),this.add(t,!0);for(n=0,e=t.length;e>n;n++)r=t[n],this.adopt(r)}},t}(),n.exports=e},{}],25:[function(t,n,e){e.Graph=t("./graph"),e.Node=t("./node"),e.Outlet=t("./outlet"),e.IN=e.Graph.IN,e.OUT=e.Graph.OUT},{"./graph":24,"./node":26,"./outlet":27}],26:[function(t,n){var e,r,i;e=t("./graph"),i=t("./outlet"),r=function(){function t(n,e){this.owner=n,this.graph=null,this.inputs=[],this.outputs=[],this.all=[],this.outlets=null,this.id=t.id(),this.setOutlets(e)}return t.index=0,t.id=function(){return++t.index},t.prototype.getIn=function(t){var n;return function(){var e,r,i,o;for(i=this.inputs,o=[],e=0,r=i.length;r>e;e++)n=i[e],n.name===t&&o.push(n);return o}.call(this)[0]},t.prototype.getOut=function(t){var n;return function(){var e,r,i,o;for(i=this.outputs,o=[],e=0,r=i.length;r>e;e++)n=i[e],n.name===t&&o.push(n);return o}.call(this)[0]},t.prototype.get=function(t){return this.getIn(t)||this.getOut(t)},t.prototype.setOutlets=function(t){var n,e,r,o,u,s,a,l,c,h,p,f;if(null!=t){if(null==this.outlets){for(this.outlets={},s=0,c=t.length;c>s;s++)u=t[s],u instanceof i||(u=i.make(u)),this._add(u);return}for(e=function(t){return[t.name,t.inout,t.type].join("-")},o={},a=0,h=t.length;h>a;a++)u=t[a],o[e(u)]=!0;f=this.outlets;for(r in f)u=f[r],r=e(u),o[r]?o[r]=u:this._remove(u);for(l=0,p=t.length;p>l;l++)u=t[l],n=o[e(u)],n instanceof i?this._morph(n,u):(u instanceof i||(u=i.make(u)),this._add(u))}return this.outlets},t.prototype.connect=function(t,n,e){var r,i,o,u,s,a,l,c,h,p,f,d;for(s={},i={},f=t.inputs,l=0,h=f.length;h>l;l++)u=f[l],(e||!u.input)&&(a=u.type,r=[a,u.hint].join("-"),i[r]||(i[r]=u),s[a]=s[a]||[],s[a].push(u));for(d=this.outputs,c=0,p=d.length;p>c;c++)u=d[c],n&&u.output.length||(a=u.type,r=[a,u.hint].join("-"),o=s[a],i[r]?(i[r].connect(u),delete i[r],o.splice(o.indexOf(u),1)):o&&o.length&&o.shift().connect(u));return this},t.prototype.disconnect=function(){var t,n,e,r,i,o,u;for(o=this.inputs,n=0,r=o.length;r>n;n++)t=o[n],t.disconnect();for(u=this.outputs,e=0,i=u.length;i>e;e++)t=u[e],t.disconnect();return this},t.prototype._key=function(t){return[t.name,t.inout].join("-")},t.prototype._add=function(t){var n;if(n=this._key(t),t.node)throw"Adding outlet to two nodes at once.";if(this.outlets[n])throw"Adding two identical outlets to same node. ("+n+")";return t.node=this,t.inout===e.IN&&this.inputs.push(t),t.inout===e.OUT&&this.outputs.push(t),this.all.push(t),this.outlets[n]=t},t.prototype._morph=function(t,n){var e;return e=this._key(n),delete this.outlets[e],t.morph(n),e=this._key(n),this.outlets[e]=n},t.prototype._remove=function(t){var n,r;if(r=this._key(t),n=t.inout,t.node!==this)throw"Removing outlet from wrong node.";return t.disconnect(),t.node=null,delete this.outlets[r],t.inout===e.IN&&this.inputs.splice(this.inputs.indexOf(t),1),t.inout===e.OUT&&this.outputs.splice(this.outputs.indexOf(t),1),this.all.splice(this.all.indexOf(t),1),this},t}(),n.exports=r},{"./graph":24,"./outlet":27}],27:[function(t,n){var e,r;e=t("./graph"),r=function(){function t(n,e,r,i,o,u){this.inout=n,this.name=e,this.hint=r,this.type=i,this.meta=null!=o?o:{},this.id=u,null==this.hint&&(this.hint=t.hint(e)),this.node=null,this.input=null,this.output=[],null==this.id&&(this.id=t.id(this.hint))}return t.make=function(n,e){var r,i,o,u;if(null==e&&(e={}),i=e,null!=n.meta){u=n.meta;for(r in u)o=u[r],i[r]=o}return new t(n.inout,n.name,n.hint,n.type,i)},t.index=0,t.id=function(n){return"_io_"+ ++t.index+"_"+n},t.hint=function(t){return t=t.replace(/^(_io_[0-9]+_)/,""),t=t.replace(/(In|Out|Inout|InOut)$/,"")},t.prototype.morph=function(t){return this.inout=t.inout,this.name=t.name,this.hint=t.hint,this.type=t.type,this.meta=t.meta},t.prototype.dupe=function(n){var e;return null==n&&(n=this.id),e=t.make(this),e.name=n,e},t.prototype.connect=function(t){if(this.inout===e.IN&&t.inout===e.OUT)return t.connect(this);if(this.inout!==e.OUT||t.inout!==e.IN)throw"Can only connect out to in.";if(t.input!==this)return t.disconnect(),t.input=this,this.output.push(t)},t.prototype.disconnect=function(t){var n,e,r,i;if(this.input&&this.input.disconnect(this),this.output.length){if(!t){for(i=this.output,e=0,r=i.length;r>e;e++)t=i[e],t.input=null;return this.output=[]}if(n=this.output.indexOf(t),n>=0)return this.output.splice(n,1),t.input=null}},t}(),n.exports=r},{"./graph":24}],28:[function(t,n){var e,r,i,o,u,s,a,l,c,h,p,f,d;e=t("./block"),r=t("./factory"),i=t("./glsl"),o=t("./graph"),u=t("./linker"),l=t("./visualize"),p=r.library,c=r.cache,d=l.visualize,h=l.inspect,a=u.Snippet,f=function(t,n){var e,r,i,o;null==n&&(n={}),r={};for(e in t)i=t[e],r[e]=null!=(o=n[e])?o:t[e];return r},s=function(){function t(n,e){var r;return this instanceof t?(r={globalUniforms:!1,globalVaryings:!0,globalAttributes:!0,globals:[],autoInspect:!1},this.config=f(r,e),void(this.fetch=c(p(i,n,a.load)))):new t(n,e)}return t.prototype.shader=function(t){var n;return null==t&&(t={}),n=f(this.config,t),new r.Factory(i,this.fetch,n)},t.prototype.material=function(t){return new r.Material(this.shader(t),this.shader(t))},t.prototype.overlay=function(n){return t.overlay(n)},t.prototype.visualize=function(n){return t.visualize(n)},t.Block=e,t.Factory=r,t.GLSL=i,t.Graph=o,t.Linker=u,t.Visualize=l,t.inspect=function(t){return h(t)},t.visualize=function(t){return d(t)},t}(),n.exports=s,"undefined"!=typeof window&&(window.ShaderGraph=s)},{"./block":8,"./factory":14,"./glsl":22,"./graph":25,"./linker":30,"./visualize":36}],29:[function(t,n){var e,r,i;e=t("../graph"),r=t("./priority"),i=function(t,n,i,o){var u,s,a,l,c,h,p,f,d,g,m,v,y,_;return l=t.generate,a={},v=[],y={},_={},s={},f={},g=function(){var t,e,u,h,p,d,g,b,k;for(d in o)g=o[d],m(g.node,g.module);return k=c(i),t=k[0],i=k[1],null!=n&&(t.entry=n),p=l.build(t,i),b=function(){var t;t=[];for(d in f)h=f[d],t.push(h);return t}().sort(function(t,n){return r.compare(t.priority,n.priority)}),u=b.map(function(t){return t.code}),u.push(p.code),e=l.lines(u),{namespace:p.name,library:f,body:p.code,code:e,main:p,entry:p.name,symbols:v,externals:a,uniforms:y,varyings:_,attributes:s}},c=function(){return function(t){var n,e,r,i,o,u;for(t=function(){var n;n=[];for(i in t)e=t[i],n.push(e);return n}(),t.sort(function(t,n){return n.priority-t.priority}),r=function(t,e,r){var i,o,u,s;return h(t,e,r),o=e.main,i=e.entry,s=function(n){return d(t,n)},u=function(n){return p(t,n)},l.call(s,u,i,o.signature,n)},n=l.body(),o=0,u=t.length;u>o;o++)e=t[o],r(e.node,e.module,e.priority);return[n,t]}}(this),u=function(t,n,e){var i;return i=f[t],null!=i?i.priority=r.max(i.priority,e):f[t]={code:n,priority:e}},h=function(t,n,e){var i,o,a,l,c,h,p,f;e=r.make(e),c=n.library;for(l in c)a=c[l],u(l,a.code,r.nest(e,a.priority));u(n.namespace,n.body,e),h=n.uniforms;for(o in h)i=h[o],y[o]=i;p=n.varyings;for(o in p)i=p[o],_[o]=i;f=n.attributes;for(o in f)i=f[o],s[o]=i;return m(t,n)},m=function(t,n){var e,r,i,o,u,s,l,c,h;for(c=n.symbols,h=[],s=0,l=c.length;l>s;s++)if(o=c[s],r=n.externals[o],p(t,r.name)){e={};for(i in r)u=r[i],e[i]=u;e.name=d(t,r.name),a[o]=e,h.push(v.push(o))}else h.push(void 0);return h},p=function(t,n){var r;return r=t.get(n),r.inout===e.IN?null===r.input:r.inout===e.OUT?0===r.output.length:void 0},d=function(t,n){var e;return(e=t.get(n))?(e.input&&(e=e.input),n=e.name,e.id):null},g()},n.exports=i},{"../graph":25,"./priority":33}],30:[function(t,n,e){e.Snippet=t("./snippet"),e.Program=t("./program"),e.Layout=t("./layout"),e.assemble=t("./assemble"),e.link=t("./link"),e.priority=t("./priority"),e.load=e.Snippet.load},{"./assemble":29,"./layout":31,"./link":32,"./priority":33,"./program":34,"./snippet":35}],31:[function(t,n){var e,r,i,o;r=t("./snippet"),o=t("./link"),i=!1,e=function(){function t(t,n){this.language=t,this.graph=n,this.links=[],this.includes=[],this.modules={},this.visits={}}return t.prototype.callback=function(t,n,e,r,i){return this.links.push({node:t,module:n,priority:e,name:r,external:i})},t.prototype.include=function(t,n,e){var r;return null!=(r=this.modules[n.namespace])?r.priority=Math.max(e,r.priority):(this.modules[n.namespace]=!0,this.includes.push({node:t,module:n,priority:e}))},t.prototype.visit=function(t){return i&&console.log("Visit",t,!this.visits[t]),this.visits[t]?!1:this.visits[t]=!0},t.prototype.link=function(t){var n,e,i;n=o(this.language,this.links,this.includes,t),i=new r;for(e in n)i[e]=n[e];return i.graph=this.graph,i},t}(),n.exports=e},{"./link":32,"./snippet":35}],32:[function(t,n){var e,r,i;e=t("../graph"),r=t("./priority"),i=function(t,n,i,o){var u,s,a,l,c,h,p,f,d,g,m,v;return l=t.generate,h=[],g=[],a={},m={},s={},v={},f={},d=function(){var t,e,u,p,d,g,y,_,b,k;for(u=l.links(n),p=[],null!=u.defs&&p.push(u.defs),null!=u.bodies&&p.push(u.bodies),b=0,k=i.length;k>b;b++)g=i[b],c(g.node,g.module,g.priority);return _=function(){var t;t=[];for(y in f)d=f[y],t.push(d);return t}().sort(function(t,n){return r.compare(t.priority,n.priority)}),h=_.map(function(t){return t.code}),t=l.lines(h),t=l.defuse(t),p.length&&(t=[l.lines(p),t].join("\n")),t=l.hoist(t),t=l.dedupe(t),e=o,{namespace:e.main.name,code:t,main:e.main,entry:e.main.name,externals:a,uniforms:m,attributes:s,varyings:v}},u=function(t,n,e){var i;return i=f[t],null!=i?i.priority=r.max(i.priority,e):f[t]={code:n,priority:e}},c=function(t,n,e){var i,o,l,c,h,f,d,y,_,b,k,x,w;e=r.make(e),y=n.library;for(h in y)c=y[h],u(h,c.code,r.nest(e,c.priority));u(n.namespace,n.body,e),_=n.uniforms;for(l in _)i=_[l],m[l]=i;b=n.varyings;for(l in b)i=b[l],v[l]=i;k=n.attributes;for(l in k)i=k[l],s[l]=i;for(x=n.symbols,w=[],f=0,d=x.length;d>f;f++)l=x[f],o=n.externals[l],p(t,o.name)?(a[l]=o,w.push(g.push(l))):w.push(void 0);return w},p=function(t,n){var r,i,o,u;if(i=t.get(n),!i)throw r=null!=(o=null!=(u=t.owner.snippet)?u._name:void 0)?o:t.owner.namespace,"Unable to link program. Unlinked callback `"+n+"` on `"+r+"`";return i.inout===e.IN?null===i.input:i.inout===e.OUT?0===i.output.length:void 0},d()},n.exports=i},{"../graph":25,"./priority":33}],33:[function(t,n,e){e.make=function(t){return null==t&&(t=[]),t instanceof Array||(t=[null!=+t?+t:0]),t},e.nest=function(t,n){return t.concat(n)},e.compare=function(t,n){var e,r,i,o,u;for(r=Math.min(t.length,n.length),e=u=0;r>=0?r>u:u>r;e=r>=0?++u:--u){if(i=t[e],o=n[e],i>o)return-1;if(o>i)return 1}return t=t.length,n=n.length,t>n?-1:n>t?1:0},e.max=function(t,n){return e.compare(t,n)>0?n:t}},{}],34:[function(t,n){var e,r,i;r=t("./snippet"),i=t("./assemble"),e=function(){function t(t,n,e){this.language=t,this.namespace=n,this.graph=e,this.calls={},this.requires={}}return t.index=0,t.entry=function(){return"_pg_"+ ++t.index+"_"},t.prototype.call=function(t,n,e){var r,i;return i=n.namespace,(r=this.calls[i])?r.priority=Math.max(r.priority,e):this.calls[i]={node:t,module:n,priority:e},this},t.prototype.require=function(t,n){var e;return e=n.namespace,this.requires[e]={node:t,module:n}},t.prototype.assemble=function(){var n,e,o,u;n=i(this.language,null!=(u=this.namespace)?u:t.entry,this.calls,this.requires),o=new r;for(e in n)o[e]=n[e];return o.graph=this.graph,o},t}(),n.exports=e},{"./assemble":29,"./snippet":35}],35:[function(t,n){var e;e=function(){function t(t,n,e,r,i){var o;this.language=t,this._signatures=n,this._compiler=e,this._name=r,this._original=i,this.namespace=null,this.code=null,this.main=null,this.entry=null,this.uniforms=null,this.externals=null,this.symbols=null,this.attributes=null,this.varyings=null,this.language||delete this.language,this._signatures||delete this._signatures,this._compiler||delete this._compiler,this._original||delete this._original,this._name||(this._name=null!=(o=this._signatures)?o.main.name:void 0)}return t.index=0,t.namespace=function(){return"_sn_"+ ++t.index+"_"},t.load=function(n,e,r){var i,o,u,s;return o=n.parse(e,r),s=n.compile(o),u=s[0],i=s[1],new t(n,u,i,e,r)},t.prototype.clone=function(){return new t(this.language,this._signatures,this._compiler,this._name,this._original)},t.prototype.bind=function(n,e,r,i){var o,u,s,a,l,c,h,p,f,d,g,m,v,y,_,b,k,x,w,M,O,C,T,j,E,I,P,R,A,L,N,q,S,U,G,z,D,F;if(e===""+e?(R=[e,null!=r?r:{},null!=i?i:{}],r=R[0],e=R[1],i=R[2]):r!==""+r&&(A=[null!=r?r:{},void 0],i=A[0],r=A[1]),this.main=this._signatures.main,this.namespace=null!=(L=null!=r?r:this.namespace)?L:t.namespace(),this.entry=this.namespace+this.main.name,this.uniforms={},this.varyings={},this.attributes={},this.externals={},this.symbols=[],l={},a={},c=function(t){return a[t]=!0,t},p=function(t){return function(n){return t.namespace+n}}(this),n.globals)for(N=n.globals,b=0,M=N.length;M>b;b++)h=N[b],c(h);for(D=n.globalUniforms?c:p,F=n.globalVaryings?c:p,y=n.globalAttributes?c:p,_=p,v=function(){return function(t){return l[t.name]=!0}}(this),g=function(t){return function(n,e){return t.uniforms[D(null!=e?e:n.name)]=n}}(this),m=function(t){return function(n){return t.varyings[F(n.name)]=n}}(this),o=function(t){return function(n){return t.attributes[y(n.name)]=n}}(this),s=function(t){return function(n){var e;return e=_(n.name),t.externals[e]=n,t.symbols.push(e)}}(this),d=function(t){return{type:t.type,name:t.name,value:t.value}},q=this._signatures.uniform,k=0,O=q.length;O>k;k++)u=q[k],v(u);for(S=this._signatures.uniform,x=0,C=S.length;C>x;x++)u=S[x],g(d(u));for(U=this._signatures.varying,w=0,T=U.length;T>w;w++)u=U[w],m(d(u));for(G=this._signatures.external,I=0,j=G.length;j>I;I++)u=G[I],s(u);for(z=this._signatures.attribute,P=0,E=z.length;E>P;P++)u=z[P],o(d(u));for(f in e)u=e[f],l[f]&&g(u,f);return this.body=this.code=this._compiler(this.namespace,a,i),null},t}(),n.exports=e},{}],36:[function(t,n,e){var r,i,o,u,s,a;r=t("../Graph").Graph,e.serialize=s=t("./serialize"),e.markup=i=t("./markup"),a=function(t){var n;if(t)return t.nodes?(n=s(t),i.process(n)):t},u=function(t){return null==t?t:t instanceof Array?t.map(u):null!=t.vertex&&null!=t.fragment?[u(t.vertex,u(t.fragment))]:null!=t._graph?t._graph:t},o=function(t){var n,e,r,i;for(e=[],r=0,i=t.length;i>r;r++)n=t[r],n instanceof Array?e=e.concat(o(n)):null!=n&&e.push(n);return e},e.visualize=function(){var t,n;return n=o(u([].slice.call(arguments))),i.merge(function(){var e,r,i;for(i=[],e=0,r=n.length;r>e;e++)t=n[e],t&&i.push(a(t));return i}())},e.inspect=function(){var t,n;return t=e.visualize.apply(null,arguments),n=i.overlay(t),document.body.appendChild(n),t.update(),n}},{"../Graph":2,"./markup":37,"./serialize":38}],37:[function(t,n){var e,r,i,o,u,s,a,l,c,h,p,f,d,g,m,v;o=t("../factory/hash"),f=function(t){return(""+t).replace(/^\s+|\s+$/g,"")},r=function(t,n,e,r){return"rgba("+[t,n,e,r].join(", ")+")"},u=function(t,n){var e,i,u,s,a,l,c;return null==n&&(n=1),i=1193046^o(t),c=255&i,u=i>>>8&255,e=i>>>16&255,s=Math.max(c,u,e),l=140/s,a=Math.round(s/3),c=Math.min(255,Math.round(l*Math.max(c,a))),u=Math.min(255,Math.round(l*Math.max(u,a))),e=Math.min(255,Math.round(l*Math.max(e,a))),r(c,u,e,n)},i=function(t){return t=null!=t?t:"",t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")},h=function(t){var n,r;return r=[],n=m(t,r),n.update=function(){return e(n,r)},g(n),n},g=function(t){var n,e,r,i,o;for(e=t.querySelectorAll(".shadergraph-code"),o=[],r=0,i=e.length;i>r;r++)n=e[r],o.push(function(){var t;return t=n,t.parentNode.classList.add("shadergraph-has-code"),t.parentNode.addEventListener("click",function(){return t.style.display={block:"none",none:"block"}[t.style.display||"none"]})}());return o},v=function(t){var n,e,r,i,o,u,s,a,l,c,h,p,f,d,g;for(i={},e={},f=t.nodes,u=0,l=f.length;l>u;u++)r=f[u],i[r.id]=r;for(d=t.links,s=0,c=d.length;c>s;s++)n=d[s],null==e[p=n.from]&&(e[p]=[]),e[n.from].push(n);for(o=function(t,r){var u,s,a,l;if(null==r&&(r=0),t.depth=Math.max(null!=(l=t.depth)?l:0,r),u=e[t.id])for(s=0,a=u.length;a>s;s++)n=u[s],o(i[n.to],r+1);return null},g=t.nodes,a=0,h=g.length;h>a;a++)r=g[a],null==r.depth&&o(r);return null},m=function(t,n){var e,r,o,s,a,l,c,h,p,d,g,y,_,b,k,x,w,M,O,C,T,j,E,I,P,R;for(v(t),y=document.createElement("div"),y.classList.add("shadergraph-graph"),l=[],g={},E=t.nodes,_=0,w=E.length;w>_;_++){for(p=E[_],r=document.createElement("div"),r.classList.add("shadergraph-node"),r.classList.add("shadergraph-node-"+p.type),r.innerHTML='<div class="shadergraph-header">'+i(p.name)+"</div>",e=function(t,n){var e,o;return e=u(t.type),o=document.createElement("div"),o.classList.add("shadergraph-outlet"),o.classList.add("shadergraph-outlet-"+n),o.innerHTML='<div class="shadergraph-point" style="background: '+e+'"></div>\n<div class="shadergraph-type" style="color: '+e+'">'+i(t.type)+'</div>\n<div class="shadergraph-name">'+i(t.name)+"</div>",r.appendChild(o),g[t.id]=o.querySelector(".shadergraph-point")},I=p.inputs,b=0,M=I.length;M>b;b++)d=I[b],e(d,"in");for(P=p.outputs,k=0,O=P.length;O>k;k++)d=P[k],e(d,"out");null!=p.graph?r.appendChild(m(p.graph,n)):(o=document.createElement("div"),o.classList.add("shadergraph-clear"),r.appendChild(o)),null!=p.code&&(c=document.createElement("div"),c.classList.add("shadergraph-code"),c.innerHTML=i(f(p.code)),r.appendChild(c)),a=l[p.depth],null==a&&(a=document.createElement("div"),a.classList.add("shadergraph-column"),l[p.depth]=a),a.appendChild(r)}for(x=0,C=l.length;C>x;x++)a=l[x],null!=a&&y.appendChild(a);for(R=t.links,j=0,T=R.length;T>j;j++)h=R[j],s=u(h.type),n.push({color:s,out:g[h.out],"in":g[h["in"]]});return y},p=function(t){return t*t},c=function(t,n,e,r){var i,o,u,s,a,l,c,h;return o=e-t,u=r-n,i=Math.sqrt(p(o)+p(u)),h=Math.abs(u)>Math.abs(o),h?(l=(t+e)/2,c=(n+r)/2,s=u>0?.3:-.3,a=Math.min(Math.abs(o)/2,20+i/8),["M",t,n,"C",t+a,n+",",l,c-i*s,l,c,"C",l,c+i*s,e-a,r+",",e,r].join(" ")):(a=Math.min(Math.abs(o)/2.5,20+i/4),["M",t,n,"C",t+a,n+",",e-a,r+",",e,r].join(" "))},s=function(t){return null==t&&(t="svg"),document.createElementNS("http://www.w3.org/2000/svg",t)},e=function(t,n){var e,r,i,o,u,a,l,h,p,f,d,g;if(null!=t.parentNode){for(l=t.getBoundingClientRect(),p=0,d=n.length;d>p;p++)a=n[p],e=a.out.getBoundingClientRect(),r=a["in"].getBoundingClientRect(),a.coords={x1:(e.left+e.right)/2-l.left,y1:(e.top+e.bottom)/2-l.top,x2:(r.left+r.right)/2-l.left,y2:(r.top+r.bottom)/2-l.top};for(h=t.querySelector("svg"),null!=h&&t.removeChild(h),i=t;i.parentNode&&0===i.offsetHeight;)i=i.parentNode;for(h=s(),h.setAttribute("width",i.offsetWidth),h.setAttribute("height",i.offsetHeight),f=0,g=n.length;g>f;f++)a=n[f],o=a.coords,u=s("path"),u.setAttribute("d",c(o.x1,o.y1,o.x2,o.y2)),u.setAttribute("stroke",a.color),u.setAttribute("stroke-width",3),u.setAttribute("fill","transparent"),h.appendChild(u);return t.appendChild(h)}},l=function(t){var n,e,r,i;return e=document.createElement("div"),e.setAttribute("class","shadergraph-overlay"),n=document.createElement("div"),n.setAttribute("class","shadergraph-close"),n.innerHTML="&times;",i=document.createElement("div"),i.setAttribute("class","shadergraph-view"),r=document.createElement("div"),r.setAttribute("class","shadergraph-inside"),r.appendChild(t),i.appendChild(r),e.appendChild(i),e.appendChild(n),n.addEventListener("click",function(){return e.parentNode.removeChild(e)}),e},d=function(t){var n;return t instanceof Node?t:(n=document.createElement("div"),n.innerText=null!=t?t:"",n)},a=function(t){var n,e,r,i;if(1!==t.length){for(n=document.createElement("div"),r=0,i=t.length;i>r;r++)e=t[r],n.appendChild(d(e));return n.update=function(){var n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push("function"==typeof e.update?e.update():void 0);return i},n}return d(t[0])},n.exports={process:h,merge:a,overlay:l}},{"../factory/hash":13}],38:[function(t,n){var e,r,i;e=t("../block"),r=function(t){return"("===t.type[0]},i=function(t){var n,r,o,u,s,a,l,c,h,p,f,d,g,m,v,y,_,b,k,x,w,M;for(a=[],u=[],k=t.nodes,f=0,v=k.length;v>f;f++){for(s=k[f],p={id:s.id,name:null,type:null,depth:null,graph:null,inputs:[],outputs:[]},a.push(p),o=p.inputs,h=p.outputs,n=s.owner,n instanceof e.Call?(p.name=n.snippet._name,p.type="call",p.code=n.snippet._original):n instanceof e.Callback?(p.name="Callback",p.type="callback",p.graph=i(n.graph)):n instanceof e.Isolate?(p.name="Isolate",p.type="isolate",p.graph=i(n.graph)):n instanceof e.Join&&(p.name="Join",p.type="join"),r=function(t){return t=t.replace(")(",")("),t=t.replace("()","")},x=s.inputs,d=0,y=x.length;y>d;d++)c=x[d],o.push({id:c.id,name:c.name,type:r(c.type),open:null==c.input});for(w=s.outputs,g=0,_=w.length;_>g;g++)for(c=w[g],h.push({id:c.id,name:c.name,type:r(c.type),open:!c.output.length}),M=c.output,m=0,b=M.length;b>m;m++)l=M[m],u.push({from:s.id,out:c.id,to:l.node.id,"in":l.id,type:r(c.type)})}return{nodes:a,links:u}},n.exports=i},{"../block":8}],39:[function(t,n){n.exports=t("./lib/index")},{"./lib/index":41}],40:[function(t,n){function e(){return this}function r(t,n){var e=v[t];return n=n||0,e?n>e.lbp&&(e.lbp=n):(e=Object.create(m),e.id=t,e.lbp=n,v[t]=e),e}function i(t){var n,e=f;for(c(),n=e.nud();t<f.lbp;)e=f,c(),n=e.led(n);return n}function o(t,n,e){var o=r(t,n);o.led=e||function(t){return this.children=[t,i(n)],this.type="binary",this}}function u(t,n,e){var o=r(t,n);return o.led=e||function(t){return this.children=[t,i(n-1)],this.type="binary",this},o}function s(t,n){var e=r(t);return e.nud=n||function(){return this.children=[i(70)],this.type="unary",this},e}function a(t){var n=r(t,150);n.led=function(t){return this.children=[t],this.type="suffix",this}}function l(t){return u(t,10,function(t){return this.children=[t,i(9)],this.assignment=!0,this.type="assign",this})}function c(t){var n,r,i,o;if(t&&f.data!==t)return p.unexpected("expected `"+t+"`, got `"+f.data+"`");if(g>=d.length)return void(f=v["(end)"]);if(n=d[g++],r=n.data,i=n.type,"ident"===i)o=p.scope.find(r)||p.create_node(),i=o.type;else if("builtin"===i)o=v["(builtin)"];else if("keyword"===i)o=v["(keyword)"];else if("operator"===i){if(o=v[r],!o)return p.unexpected("unknown operator `"+r+"`")}else{if("float"!==i&&"integer"!==i)return p.unexpected("unexpected token.");i="literal",o=v["(literal)"]}return o&&(o.nud||(o.nud=e),o.children||(o.children=[])),o=Object.create(o),o.token=n,o.type=i,o.data||(o.data=r),f=o}function h(t){return function(){return p.unexpected(t)}}var p,f,d,g,m={nud:function(){return this.children&&this.children.length?this:h("unexpected")()},led:h("missing operator")},v={};r("(ident)").nud=e,r("(keyword)").nud=e,r("(builtin)").nud=e,r("(literal)").nud=e,r("(end)"),r(":"),r(";"),r(","),r(")"),r("]"),r("}"),u("&&",30),u("||",30),o("|",43),o("^",44),o("&",45),o("==",46),o("!=",46),o("<",47),o("<=",47),o(">",47),o(">=",47),o(">>",48),o("<<",48),o("+",50),o("-",50),o("*",60),o("/",60),o("%",60),o("?",20,function(t){return this.children=[t,i(0),(c(":"),i(0))],this.type="ternary",this}),o(".",80,function(t){return f.type="literal",p.fake(f),this.children=[t,f],c(),this}),o("[",80,function(t){return this.children=[t,i(0)],this.type="binary",c("]"),this}),o("(",80,function(t){if(this.children=[t],this.type="call",")"!==f.data)for(;;){if(this.children.push(i(0)),","!==f.data)break;c(",")}return c(")"),this}),s("-"),s("+"),s("!"),s("~"),s("defined"),s("(",function(){return this.type="group",this.children=[i(0)],c(")"),this}),s("++"),s("--"),a("++"),a("--"),l("="),l("+="),l("-="),l("*="),l("/="),l("%="),l("&="),l("|="),l("^="),l(">>="),l("<<="),n.exports=function(t,n){function e(t){p.unshift(t,!1);for(var n=0,r=t.children.length;r>n;++n)e(t.children[n]);p.shift()}p=t,d=n,g=0;var r;if(d.length){if(c(),r=i(0),r.parent=p[0],e(r),g<d.length)throw new Error("did not use all tokens");r.parent.children=[r]}}},{}],41:[function(t,n){function e(){function t(t){if("whitespace"===t.type||"line-comment"===t.type||"block-comment"===t.type)return void Kn.push(t);for(Qn.push(t),Rn=Rn||Qn[0],Rn&&Kn.length&&(Rn.preceding=Rn.preceding||[],Rn.preceding=Rn.preceding.concat(Kn),Kn=[]);e();)switch($n[0].mode){case d:Q();break;case g:G();break;case _:K();break;case b:X();break;case M:en();break;case m:kn(!0,!0);break;case O:xn();break;case f:nn();break;case j:tn();break;case E:Y();break;case v:En();break;case y:In();break;case k:Mn();break;case x:Tn();break;case L:jn();break;case I:Cn();break;case w:On();break;case q:wn()}}function n(n){return arguments.length&&t(n),$n.length>1?void cn("unexpected EOF"):void Jn.emit("end")}function e(){return Xn||!$n.length?!1:(Rn=Qn[0])&&!Jn.paused}function p(t){$n.unshift(t),$n.shift()}function C(t,n){t.parent=$n[0];var e=[].unshift.call(this,t);if(n=void 0===n?!0:n,h){for(var r="",i=0,o=this.length-1;o>i;++i)r+=" |";console.log(r,"\\"+t.type,t.token.data)}return n&&An!==t&&An.children.push(t),An=t,e}function T(){var t=[].shift.call(this),n=Wn[this.length],e=!1;if(h){for(var r="",i=0,o=this.length;o>i;++i)r+=" |";console.log(r,"/"+t.type)}return Wn.length?"function"==typeof Wn[0]?e=Wn[0](t):void 0!==n&&(e=n.test?n.test(t.type):n===t.type):e=!0,e&&Jn.emit("data",t),An=t.parent,t}function G(){function t(){if(Rn.data===$n[0].expecting)return $n.scope.exit(),$n.shift();switch(Rn.type){case"preprocessor":return $n.fake(on()),void Qn.shift();default:return void $n.unshift(Nn())}}return fn(function(){return $n.scope.enter(),c},t)()}function Q(){if($n[0].brace)return"}"!==Rn.data?cn("expected `}`, got "+Rn.data):($n[0].brace=!1,Qn.shift(),$n.shift());switch(Rn.type){case"eof":return $n.shift();case"keyword":switch(Rn.data){case"for":return $n.unshift(Dn());case"if":return $n.unshift(Fn());case"while":return $n.unshift(Vn());case"do":return $n.unshift(Bn());case"break":return $n.fake(r(P,Rn)),Qn.shift();case"continue":return $n.fake(r(R,Rn)),Qn.shift();case"discard":return $n.fake(r(A,Rn)),Qn.shift();case"return":return $n.unshift(Hn());case"precision":return $n.unshift(Sn())}return $n.unshift(un(H));case"ident":var t;if(t=$n.scope.find(Rn.data))return $n.unshift("struct"===t.parent.type?un(H):an(";"));case"operator":if("{"===Rn.data){$n[0].brace=!0;var n=Ln();return n.expecting="}",Qn.shift(),$n.unshift(n)}if(";"===Rn.data)return Qn.shift(),$n.shift();default:return $n.unshift(an(";"))}}function K(){function t(){return"invariant"===Rn.data?d.flags&z?($n.unshift(ln()),c):cn("`invariant` is not allowed here"):($n.fake(r(N,{data:"",position:Rn.position})),c)}function n(){return i(Rn)?d.flags&D?($n.unshift(ln()),c):cn("storage is not allowed here"):($n.fake(r(N,{data:"",position:Rn.position})),c)}function e(){return o(Rn)?d.flags&F?cn("parameter is not allowed here"):($n.unshift(ln()),c):($n.fake(r(N,{data:"",position:Rn.position})),c)}function s(){return u(Rn)?($n.unshift(ln()),c):($n.fake(r(N,{data:"",position:Rn.position})),c)}function a(){if("struct"===Rn.data)return d.flags&V?($n.unshift(sn()),c):cn("cannot nest structs");if("keyword"===Rn.type)return $n.unshift(ln()),c;var t=$n.scope.find(Rn.data);return t?($n.fake(Object.create(t)),Qn.shift(),c):cn("expected user defined type, struct or keyword, got "+Rn.data)}function l(){return","!==Rn.data||d.flags&U?"["===Rn.data?void $n.unshift(Zn()):")"===Rn.data?$n.shift():";"===Rn.data?d.stage+3:"ident"!==Rn.type?(console.log(Rn),cn("expected identifier, got "+Rn.data)):(d.collected_name=Qn.shift(),c):$n.shift()}function h(){return"("===Rn.data?(Qn.unshift(d.collected_name),delete d.collected_name,$n.unshift(Gn()),d.stage+2):c}function p(){return Qn.unshift(d.collected_name),delete d.collected_name,$n.unshift(qn()),c}function f(){return $n.shift()}var d=$n[0];return fn(t,n,e,s,a,l,h,p,f)()}function X(){if("ident"===Rn.type){var t=Rn.data;return $n.unshift(Un()),void $n.scope.define(t)}if("operator"===Rn.type){if(","===Rn.data)return $n[1].flags&U?Qn.shift():$n.shift();if("="===Rn.data)return $n[1].flags&S?(Qn.shift(),void $n.unshift(an(",",";"))):cn("`=` is not allowed here.");if("["===Rn.data)return void $n.unshift(Zn())}return $n.shift()}function Y(){return"keyword"===Rn.type?($n[0].type="keyword",void($n[0].mode=j)):"ident"===Rn.type?($n[0].type="ident",void($n[0].mode=f)):cn("expected keyword or user-defined name, got "+Rn.data)}function tn(){return"keyword"!==Rn.type?cn("expected keyword, got "+Rn.data):($n.shift(),Qn.shift())}function nn(){return"ident"!==Rn.type?cn("expected user-defined name, got "+Rn.data):($n[0].data=Rn.data,$n.shift(),Qn.shift())}function en(){function t(t){return a($n,t),$n.shift()}var n=$n[0].expecting;if($n[0].tokens=$n[0].tokens||[],void 0===$n[0].parenlevel&&($n[0].parenlevel=0,$n[0].bracelevel=0),$n[0].parenlevel<1&&n.indexOf(Rn.data)>-1)return t($n[0].tokens);switch("("===Rn.data?++$n[0].parenlevel:")"===Rn.data&&--$n[0].parenlevel,Rn.data){case"{":++$n[0].bracelevel;break;case"}":--$n[0].bracelevel;break;case"(":++$n[0].parenlevel;break;case")":--$n[0].parenlevel}return $n[0].parenlevel<0?cn("unexpected `)`"):$n[0].bracelevel<0?cn("unexpected `}`"):void $n[0].tokens.push(Qn.shift())}function rn(t){return function(){return r(t,Rn)}}function on(){return r($[Rn.type],Rn,An)}function un(t){var n=r(_,Rn,An);return n.flags=t,n}function sn(t,n){var e=r(m,Rn,An);return e.allow_assign=void 0===t?!0:t,e.allow_comma=void 0===n?!0:n,e}function an(){var t=r(M,Rn,An);return t.expecting=[].slice.call(arguments),t}function ln(t){var n=Rn;return t&&(n={type:"(implied)",data:"(default)",position:n.position}),r(j,n,An)}function cn(t){Xn=!0,Jn.emit("error",new Error((t||"unexpected "+$n)+" at line "+$n[0].token.line))}function hn(t,n){return pn(t,Rn.type)&&pn(n,Rn.data)}function pn(t,n){switch(typeof t){case"string":return n!==t&&cn("expected `"+t+"`, got "+n+"\n"+Rn.data),!Xn;case"object":return t&&-1===t.indexOf(n)&&cn("expected one of `"+t.join("`, `")+"`, got "+n),!Xn}return!0}function fn(){var t,n,e=[].slice.call(arguments);return function(){var r=$n[0];return r.stage||(r.stage=0),(t=e[r.stage])?(n=t(),n===c?++r.stage:void(void 0!==n&&(r.stage=n))):cn("parser in undefined state!")}}function dn(t,n){return n=n||"operator",function(){if(hn(n,t)){var e=Qn.shift(),r=$n[0].children,i=r[r.length-1];return i&&i.token&&e.preceding&&(i.token.succeeding=i.token.succeeding||[],i.token.succeeding=i.token.succeeding.concat(e.preceding)),c}}}function gn(t){return function(){return $n.unshift(an(t)),c}}function mn(t){return t?function(){var t=Rn.data;return hn("ident")&&($n.unshift(Un()),$n.scope.define(t),c)}:function(){if(hn("ident")){var t=Object.create($n.scope.find(Rn.data));return t.token=Rn,Qn.shift(),c}}}function vn(){return function(){var t=Ln();
return t.expecting="}",$n.unshift(t),c}}function yn(t){return function(){var n=$n[0].stage;return"{"!==Rn.data?($n.unshift(Nn()),n+t):(Qn.shift(),c)}}function _n(){return function(){return $n.shift(),$n.shift()}}function bn(){kn=fn(dn("struct","keyword"),function(){return"{"===Rn.data?($n.fake(r(f,{data:"",position:Rn.position,type:"ident"})),c):mn(!0)()},function(){return $n.scope.enter(),c},dn("{"),function(){return"}"===Rn.data?($n.scope.exit(),Qn.shift(),$n.shift()):";"===Rn.data?void Qn.shift():void $n.unshift(un(Z))}),xn=fn(function(){return Qn.shift(),c},function(){return hn("keyword",["lowp","mediump","highp"])&&($n.unshift(ln()),c)},function(){return $n.unshift(ln()),c},function(){return $n.shift()}),wn=fn(dn("["),gn("]"),dn("]"),function(){return $n.shift()}),Mn=fn(dn("for","keyword"),dn("("),function(){var t;if("ident"===Rn.type){if((t=$n.scope.find(Rn.data))||(t=$n.create_node()),"struct"===t.parent.type)return $n.unshift(un(H)),c}else if("builtin"===Rn.type||"keyword"===Rn.type)return $n.unshift(un(H)),c;return gn(";")()},dn(";"),gn(";"),dn(";"),gn(")"),dn(")"),yn(3),vn(),dn("}"),_n()),On=fn(dn("if","keyword"),dn("("),gn(")"),dn(")"),yn(3),vn(),dn("}"),function(){return"else"===Rn.data?(Qn.shift(),$n.unshift(Nn()),c):_n()()},_n()),Cn=fn(dn("return","keyword"),function(){return";"===Rn.data?c:($n.unshift(an(";")),c)},function(){Qn.shift(),_n()()}),Tn=fn(dn("while","keyword"),dn("("),gn(")"),dn(")"),yn(3),vn(),dn("}"),_n()),jn=fn(dn("do","keyword"),yn(3),vn(),dn("}"),dn("while","keyword"),dn("("),gn(")"),dn(")"),_n()),En=fn(function(){for(var t=1,n=$n.length;n>t;++t)if($n[t].mode===v)return cn("function definition is not allowed within another function");return c},function(){if(hn("ident")){var t=Rn.data,n=$n.scope.find(t);return $n.unshift(Un()),$n.scope.define(t),$n.scope.enter(n?n.scope:null),c}},dn("("),function(){return $n.unshift(zn()),c},dn(")"),function(){return";"===Rn.data?($n.scope.exit(),$n.shift(),$n.shift()):c},dn("{"),vn(),dn("}"),function(){return $n.scope.exit(),c},function(){return $n.shift(),$n.shift(),$n.shift()}),In=fn(function(){return"void"===Rn.data?($n.fake(ln()),Qn.shift(),c):")"===Rn.data?void $n.shift():"struct"===Rn.data?($n.unshift(sn(J,W)),c):($n.unshift(un(B)),c)},function(){return","===Rn.data?(Qn.shift(),0):")"===Rn.data?void $n.shift():void cn("expected one of `,` or `)`, got "+Rn.data)})}var kn,xn,wn,Mn,On,Cn,Tn,jn,En,In,Pn,Rn,An,Ln=rn(g),Nn=rn(d),qn=rn(b),Sn=rn(O),Un=rn(f),Gn=(rn(E),rn(v)),zn=rn(y),Dn=rn(k),Fn=rn(w),Vn=rn(x),Hn=rn(I),Bn=rn(L),Zn=rn(q),Jn=s(t,n),Wn=arguments.length?[].slice.call(arguments):[],$n=[],Qn=[],Kn=[],Xn=!1;return $n.shift=T,$n.unshift=C,$n.fake=p,$n.unexpected=cn,$n.scope=new l($n),$n.create_node=function(){var t=r(f,Rn);return t.parent=Jn.program,t},bn(),An=Ln(),An.expecting="(eof)",An.mode=g,An.token={type:"(program)",data:"(program)"},Pn=An,Jn.program=Pn,Jn.scope=function(t){return 1===arguments.length&&($n.scope=t),$n.scope},$n.unshift(An),Jn}function r(t,n){return{mode:t,token:n,children:[],type:Q[t]}}function i(t){return"const"===t.data||"attribute"===t.data||"uniform"===t.data||"varying"===t.data}function o(t){return"in"===t.data||"inout"===t.data||"out"===t.data}function u(t){return"highp"===t.data||"mediump"===t.data||"lowp"===t.data}n.exports=e;var s=t("../../through"),a=t("./expr"),l=t("./scope"),c=new Object,h=!1,p=0,f=p++,d=p++,g=p++,m=p++,v=p++,y=p++,_=p++,b=p++,k=p++,x=p++,w=p++,M=p++,O=p++,C=p++,T=p++,j=p++,E=p++,I=p++,P=p++,R=p++,A=p++,L=p++,N=p++,q=p++,S=1,U=2,G=4,z=8,D=16,F=32,V=64,H=255,B=H&~(S|U|F|z|G),Z=H&~(S|z|D|V),J=!1,W=!1,$={"block-comment":C,"line-comment":C,preprocessor:T},Q=p=["ident","stmt","stmtlist","struct","function","functionargs","decl","decllist","forloop","whileloop","if","expr","precision","comment","preprocessor","keyword","keyword_or_ident","return","break","continue","discard","do-while","placeholder","quantifier"]},{"../../through":47,"./expr":40,"./scope":42}],42:[function(t,n){function e(t){return this.constructor!==e?new e(t):(this.state=t,this.scopes=[],void(this.current=null))}n.exports=e;var r=e,i=r.prototype;i.enter=function(t){this.scopes.push(this.current=this.state[0].scope=t||{})},i.exit=function(){this.scopes.pop(),this.current=this.scopes[this.scopes.length-1]},i.define=function(t){this.current[t]=this.state[0]},i.find=function(t){for(var n=this.scopes.length-1;n>-1;--n)if(this.scopes[n].hasOwnProperty(t))return this.scopes[n][t];return null}},{}],43:[function(t,n){function e(){function t(t){t.length&&q.queue({type:k[G],data:t,position:F,line:D})}function n(t){for(S=0,B+=t.toString(),N=B.length;A=B[S],N>S;)switch(G){case l:S=C();break;case c:S=O();break;case h:S=M();break;case p:S=T();break;case f:S=I();break;case b:S=E();break;case d:S=P();break;case a:S=R();break;case y:S=w();break;case s:S=x()}U+=S,B=B.slice(S)}function e(){z.length&&t(z.join("")),G=_,t("(eof)"),q.queue(null)}function x(){return z=z.length?[]:z,"/"===L&&"*"===A?(F=U+S-1,G=l,L=A,S+1):"/"===L&&"/"===A?(F=U+S-1,G=c,L=A,S+1):"#"===A?(G=h,F=U+S,S):/\s/.test(A)?(G=y,F=U+S,S):(V=/\d/.test(A),H=/[^\w_]/.test(A),F=U+S,G=V?f:H?p:a,S)}function w(){return"\n"===A&&++D,/[^\s]/g.test(A)?(t(z.join("")),G=s,S):(z.push(A),L=A,S+1)}function M(){return"\n"===A&&++D,"\n"===A&&"\\"!==L?(t(z.join("")),G=s,S):(z.push(A),L=A,S+1)}function O(){return M()}function C(){return"/"===A&&"*"===L?(z.push(A),t(z.join("")),G=s,S+1):("\n"===A&&++D,z.push(A),L=A,S+1)}function T(){if("."===L&&/\d/.test(A))return G=d,S;if("/"===L&&"*"===A)return G=l,S;if("/"===L&&"/"===A)return G=c,S;if("."===A&&z.length){for(;j(z););return G=d,S}if(";"===A){if(z.length)for(;j(z););return t(A),G=s,S+1}var n=2===z.length&&"="!==A;if(/[\w_\d\s]/.test(A)||n){for(;j(z););return G=s,S}return z.push(A),L=A,S+1}function j(n){for(var e,r=0,i=n.length;;){e=o.indexOf(n.slice(0,n.length+r).join(""));{if(-1!==e)return t(o[e]),F+=o[e].length,z=z.slice(o[e].length),z.length;if(r-=1,i-=1,0>i)return 0}}}function E(){return/[^a-fA-F0-9]/.test(A)?(t(z.join("")),G=s,S):(z.push(A),L=A,S+1)}function I(){return"."===A?(z.push(A),G=d,L=A,S+1):/[eE]/.test(A)?(z.push(A),G=d,L=A,S+1):"x"===A&&1===z.length&&"0"===z[0]?(G=b,z.push(A),L=A,S+1):/[^\d]/.test(A)?(t(z.join("")),G=s,S):(z.push(A),L=A,S+1)}function P(){return"f"===A&&(z.push(A),L=A,S+=1),/[eE]/.test(A)?(z.push(A),L=A,S+1):/[^\d]/.test(A)?(t(z.join("")),G=s,S):(z.push(A),L=A,S+1)}function R(){if(/[^\d\w_]/.test(A)){var n=z.join("");return G=i.indexOf(n)>-1?v:u.indexOf(n)>-1?m:g,t(z.join("")),G=s,S}return z.push(A),L=A,S+1}var A,L,N,q=r(n,e),S=0,U=0,G=s,z=[],D=1,F=0,V=!1,H=!1,B="";return q}n.exports=e;var r=t("../through"),i=t("./lib/literals"),o=t("./lib/operators"),u=t("./lib/builtins"),s=999,a=9999,l=0,c=1,h=2,p=3,f=4,d=5,g=6,m=7,v=8,y=9,_=10,b=11,k=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"../through":47,"./lib/builtins":44,"./lib/literals":45,"./lib/operators":46}],44:[function(t,n){n.exports=["gl_Position","gl_PointSize","gl_ClipVertex","gl_FragCoord","gl_FrontFacing","gl_FragColor","gl_FragData","gl_FragDepth","gl_Color","gl_SecondaryColor","gl_Normal","gl_Vertex","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_FogCoord","gl_MaxLights","gl_MaxClipPlanes","gl_MaxTextureUnits","gl_MaxTextureCoords","gl_MaxVertexAttribs","gl_MaxVertexUniformComponents","gl_MaxVaryingFloats","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformComponents","gl_MaxDrawBuffers","gl_ModelViewMatrix","gl_ProjectionMatrix","gl_ModelViewProjectionMatrix","gl_TextureMatrix","gl_NormalMatrix","gl_ModelViewMatrixInverse","gl_ProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverse","gl_TextureMatrixInverse","gl_ModelViewMatrixTranspose","gl_ProjectionMatrixTranspose","gl_ModelViewProjectionMatrixTranspose","gl_TextureMatrixTranspose","gl_ModelViewMatrixInverseTranspose","gl_ProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixInverseTranspose","gl_TextureMatrixInverseTranspose","gl_NormalScale","gl_DepthRangeParameters","gl_DepthRange","gl_ClipPlane","gl_PointParameters","gl_Point","gl_MaterialParameters","gl_FrontMaterial","gl_BackMaterial","gl_LightSourceParameters","gl_LightSource","gl_LightModelParameters","gl_LightModel","gl_LightModelProducts","gl_FrontLightModelProduct","gl_BackLightModelProduct","gl_LightProducts","gl_FrontLightProduct","gl_BackLightProduct","gl_FogParameters","gl_Fog","gl_TextureEnvColor","gl_EyePlaneS","gl_EyePlaneT","gl_EyePlaneR","gl_EyePlaneQ","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_ObjectPlaneR","gl_ObjectPlaneQ","gl_FrontColor","gl_BackColor","gl_FrontSecondaryColor","gl_BackSecondaryColor","gl_TexCoord","gl_FogFragCoord","gl_Color","gl_SecondaryColor","gl_TexCoord","gl_FogFragCoord","gl_PointCoord","radians","degrees","sin","cos","tan","asin","acos","atan","pow","exp","log","exp2","log2","sqrt","inversesqrt","abs","sign","floor","ceil","fract","mod","min","max","clamp","mix","step","smoothstep","length","distance","dot","cross","normalize","faceforward","reflect","refract","matrixCompMult","lessThan","lessThanEqual","greaterThan","greaterThanEqual","equal","notEqual","any","all","not","texture2D","texture2DProj","texture2DLod","texture2DProjLod","textureCube","textureCubeLod"]},{}],45:[function(t,n){n.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],46:[function(t,n){n.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],47:[function(t,n){var e;e=function(t,n){var e,r;return r=[],e=[],{output:r,parser:null,write:t,end:n,process:function(n,e){return this.parser=n,t(e),this.flush(),this.parser.flush()},flush:function(){return n(),[r,e]},queue:function(t){var n;return null!=t&&null!=(n=this.parser)?n.write(t):void 0},emit:function(t,n){return"data"===t&&null==n.parent&&r.push(n),"error"===t?e.push(n):void 0}}},n.exports=e},{}]},{},[28]);